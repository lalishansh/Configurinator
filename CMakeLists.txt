CMAKE_MINIMUM_REQUIRED(VERSION 3.21)

include(./~scripts/functions.cmake)
FIND_VCPKG()

# Enable testing for the project
enable_testing()

# Project information
PROJECT(Configurinator VERSION "0.0.1" LANGUAGES CXX)

# Generate version.h file
SET(GENERATED_SOURCE_FILES_DIR "${CMAKE_CURRENT_BINARY_DIR}/generated")
FILE(MAKE_DIRECTORY ${GENERATED_SOURCE_FILES_DIR})
FILE(WRITE "${GENERATED_SOURCE_FILES_DIR}/version.h"
        "#pragma once\n"
        "// This file is generated by CMake\n"
        "// Do not edit this file\n\n"
        "#define PROJECT_NAME                    ${PROJECT_NAME}\n"
        "#define ${PROJECT_NAME}_VERSION_MAJOR   ${${PROJECT_NAME}_VERSION_MAJOR}\n"
        "#define ${PROJECT_NAME}_VERSION_MINOR   ${${PROJECT_NAME}_VERSION_MINOR}\n"
        "#define ${PROJECT_NAME}_VERSION_PATCH   ${${PROJECT_NAME}_VERSION_PATCH}\n"
        "#define ${PROJECT_NAME}_VERSION_STRING \"${${PROJECT_NAME}_VERSION}\"\n"
    )

SET(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_SCAN_FOR_MODULES ON)
SET(CMAKE_CXX_STANDARD_REQUIRED ON)

# Projects
ADD_SUBDIRECTORY(Main)

# Packaging information
SET(CPACK_PACKAGE_VENDOR "Ishansh Lal")
SET(CPACK_PACKAGE_CONTACT "${CPACK_PACKAGE_VENDOR} <lalishansh@gmail.com>")
SET(CPACK_PACKAGE_DESCRIPTION_SUMMARY "Configuration framework written in python to facilitate configuration of platforms, environments in there native scripting language.")
SET(CPACK_RESOURCE_FILE_LICENSE "${CMAKE_CURRENT_SOURCE_DIR}/LICENSE")

CREATE_PACKAGES_VIA_CPACK(ON)
